import{_ as f,r as c,o as y,c as n,b as r,d as e,t as a,F as v,h as w,l,n as _}from"./index-y-aUSKFk.js";const k={class:"container mx-auto p-4 sm:p-2 lg:p-2"},j={key:0,class:"flex justify-center items-center h-64"},L={key:1,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-6",role:"alert"},D={class:"block sm:inline ml-2"},S={key:2,class:"flex justify-center items-center h-64"},T={key:3,class:"bg-white rounded-xl shadow-lg overflow-hidden"},$={class:"overflow-x-auto"},B={class:"min-w-full divide-y divide-gray-200"},C={class:"bg-white divide-y divide-gray-200"},E={class:"px-6 py-4 whitespace-nowrap"},F={class:"flex flex-col"},P={class:"text-sm font-semibold text-gray-900"},V={class:"text-xs text-gray-500 mt-1"},z={class:"px-6 py-4"},G={class:"flex flex-col"},A={class:"text-sm font-medium text-gray-900"},I={class:"text-xs text-gray-500 mt-1 max-w-xs"},M={class:"px-6 py-4 whitespace-nowrap"},H={class:"text-sm text-gray-900"},U={class:"font-semibold"},K={class:"px-6 py-4 whitespace-nowrap"},N={class:"px-6 py-4 whitespace-nowrap text-right"},O={class:"flex justify-end space-x-3"},J=["href"],R=["onClick","disabled"],q={key:0,class:"flex items-center"},Q={key:1,class:"flex items-center"},W={class:"bg-gray-50 px-6 py-3 border-t border-gray-200"},X={class:"flex justify-between items-center"},Y={class:"text-sm text-gray-500"},Z={class:"font-semibold"},ee={__name:"ListSurat",setup(te){const m="http://localhost:3000/api",d=c([]),x=c(!0),u=c(null),i=c({}),g=async()=>{x.value=!0,u.value=null;try{const o=localStorage.getItem("token");if(!o)throw new Error("Token not found. Please log in.");const t=await fetch(`${m}/pengajuan/generated-drafts`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`}});if(!t.ok)throw new Error(`HTTP error! Status: ${t.status}`);const s=await t.json();d.value=s}catch(o){console.error("Failed to fetch drafts:",o),u.value=o.message}finally{x.value=!1}},h=async o=>{if(!i.value[o]){i.value={...i.value,[o]:!0};try{const t=localStorage.getItem("token");if(!t)throw new Error("Token not found. Please log in.");const s=await fetch(`${m}/pengajuan/${o}/send-document`,{method:"POST",headers:{Authorization:`Bearer ${t}`}});if(!s.ok){const p=await s.json();throw new Error(p.message||`Failed to generate document! Status: ${s.status}`)}alert("Dokumen final berhasil digenerasi dan dikirim!"),await g()}catch(t){console.error("Failed to generate final document:",t),alert(`Gagal menggenerasi dokumen: ${t.message}`)}finally{i.value={...i.value,[o]:!1}}}},b=o=>{switch(o){case"approved":return"bg-green-100 text-green-800 border border-green-200";case"pending":return"bg-yellow-100 text-yellow-800 border border-yellow-200";case"rejected":return"bg-red-100 text-red-800 border border-red-200";default:return"bg-gray-100 text-gray-800 border border-gray-200"}};return y(()=>{g()}),(o,t)=>(r(),n("div",k,[x.value?(r(),n("div",j,t[0]||(t[0]=[e("div",{class:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-blue-500"},null,-1)]))):u.value?(r(),n("div",L,[t[1]||(t[1]=e("strong",{class:"font-bold"},"Error!",-1)),e("span",D,a(u.value),1)])):d.value.length===0?(r(),n("div",S,t[2]||(t[2]=[e("div",{class:"text-center"},[e("svg",{class:"mx-auto h-12 w-12 text-gray-400 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})]),e("p",{class:"text-gray-500 text-xl"},"Tidak ada draf dokumen yang tersedia.")],-1)]))):(r(),n("div",T,[t[13]||(t[13]=e("div",{class:"bg-gradient-to-r from-blue-900 to-blue-900 px-6 py-4"},[e("h3",{class:"text-lg font-semibold text-white"},"Daftar Draf Dokumen")],-1)),e("div",$,[e("table",B,[t[9]||(t[9]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider"}," Informasi Pengajuan "),e("th",{class:"px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider"}," Pemilik & Lokasi "),e("th",{class:"px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider"}," Detail Lahan "),e("th",{class:"px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider"}," Status "),e("th",{class:"px-6 py-4 text-right text-xs font-semibold text-gray-600 uppercase tracking-wider"}," Actions ")])],-1)),e("tbody",C,[(r(!0),n(v,null,w(d.value,s=>(r(),n("tr",{key:s.id,class:"hover:bg-gray-50 transition-colors duration-200"},[e("td",E,[e("div",F,[e("div",P,a(s.JenisPengajuan.name),1),e("div",V,[t[3]||(t[3]=e("span",{class:"font-medium"},"Kode:",-1)),l(" "+a(s.kode_pengajuan),1)])])]),e("td",z,[e("div",G,[e("div",A,a(s.Owner.nama),1),e("div",I,[l(a(s.Lahan.alamat_rt)+", "+a(s.Lahan.alamat_rw)+",",1),t[4]||(t[4]=e("br",null,null,-1)),l(" "+a(s.Lahan.wilayah_kelurahan)+", "+a(s.Lahan.wilayah_kecamatan),1)])])]),e("td",M,[e("div",H,[e("span",U,a(s.Lahan.luas_lahan),1),t[5]||(t[5]=l(" mÂ² "))])]),e("td",K,[e("span",{class:_([b(s.status),"inline-flex px-3 py-1 text-xs font-semibold rounded-full capitalize"])},a(s.status),3)]),e("td",N,[e("div",O,[e("a",{href:s.draft_document_url,target:"_blank",class:"inline-flex items-center px-3 py-2 bg-blue-900 hover:bg-blue-900 text-white text-xs font-medium rounded-lg transition-colors duration-200 shadow-sm hover:shadow-md",title:"Unduh Draf Dokumen"},t[6]||(t[6]=[e("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})],-1),l(" Unduh ")]),8,J),e("button",{onClick:p=>h(s.id),disabled:i.value[s.id],class:"inline-flex items-center px-3 py-2 bg-red-500 hover:bg-red-600 text-white text-xs font-medium rounded-lg transition-colors duration-200 shadow-sm hover:shadow-md disabled:bg-gray-400 disabled:cursor-not-allowed disabled:shadow-none",title:"Generate Dokumen Final"},[i.value[s.id]?(r(),n("span",q,t[7]||(t[7]=[e("div",{class:"animate-spin rounded-full h-3 w-3 border-t-2 border-b-2 border-white mr-1"},null,-1),l(" Loading... ")]))):(r(),n("span",Q,t[8]||(t[8]=[e("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),l(" Generate ")])))],8,R)])])]))),128))])])]),e("div",W,[e("div",X,[e("div",Y,[t[10]||(t[10]=l(" Total: ")),e("span",Z,a(d.value.length),1),t[11]||(t[11]=l(" draf dokumen "))]),t[12]||(t[12]=e("div",{class:"text-xs text-gray-400"},'Klik "Generate" untuk membuat dokumen final',-1))])])]))]))}},oe=f(ee,[["__scopeId","data-v-e1e4b396"]]);export{oe as default};
