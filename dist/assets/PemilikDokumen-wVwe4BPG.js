import{_ as N,u as J,a as F,r as o,i as T,o as E,c as n,b as s,e as U,d as e,f as $,k as y,t as d,l as x,g as w,w as j,H as q,F as V,h as G,D as R,v as z,x as L,S}from"./index-LTeQX8W8.js";const K={class:"min-h-screen bg-gray-50"},O={class:"max-w-7xl mx-auto px-6 py-8"},Q={key:0,class:"text-center py-12"},W={key:1,class:"text-center py-12"},X={class:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md mx-auto"},Y={class:"text-red-600 font-medium mb-4"},Z={key:2,class:"space-y-6"},ee={class:"bg-white rounded-xl shadow-sm border border-gray-200 p-6"},te={class:"space-y-4"},ae=["value"],ne={key:0,class:"bg-blue-50 border border-blue-200 rounded-lg p-4"},se={class:"flex items-start"},oe={class:"text-sm text-blue-700"},le={key:0,class:"bg-white rounded-xl shadow-sm border border-gray-200 p-6"},re=["placeholder"],ie={class:"flex justify-end"},ue=["disabled"],de={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24"},ce={key:1,class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},pe={key:1,class:"bg-green-50 border border-green-200 rounded-xl p-6"},me={class:"flex items-center"},ve={class:"text-green-700 text-sm"},ge={class:"text-green-700 text-sm"},be={__name:"PemilikDokumen",setup(xe){const _=J(),C=F(),f=o([]),i=o(""),r=o(""),c=o(""),h=o(!0),p=o(!1),m=o(null),v=o(!1),g=o(null),b=o(null),k=localStorage.getItem("token"),B=parseInt(localStorage.getItem("id"))||null,u=T(()=>f.value.find(a=>a.id_pengajuan===parseInt(i.value))),P=T(()=>i.value&&r.value.trim()),M=async()=>{try{h.value=!0,m.value=null;const a=await L.get("http://localhost:3001/api/documents/pengajuan/names",{headers:{Authorization:`Bearer ${k}`}});f.value=a.data;const t=C.params.id_pengajuan||C.query.id_pengajuan;t&&(i.value=parseInt(t),I())}catch(a){console.error("Error fetching pengajuan:",a),m.value=a.response?.data?.message||"Gagal memuat data pengajuan"}finally{h.value=!1}},I=()=>{u.value?r.value=u.value.nama_pengajuan:r.value="",c.value="",v.value=!1,g.value=null,b.value=null},A=async()=>{if(P.value)try{p.value=!0;const a={id_pengajuan:parseInt(i.value),application_title:r.value,additional_notes:c.value||null,user_id:B},t=await L.post("http://localhost/api/documents/applications",a,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${k}`}});g.value=t.data.id||"N/A",b.value=r.value,v.value=!0,S.fire({icon:"success",title:"Berhasil!",text:"Pengajuan berhasil dibuat",confirmButtonColor:"#10b981"})}catch(a){console.error("Error creating application:",a),S.fire({icon:"error",title:"Gagal Membuat Pengajuan",text:a.response?.data?.message||"Terjadi kesalahan saat membuat pengajuan",confirmButtonColor:"#ef4444"})}finally{p.value=!1}},D=()=>{i.value="",r.value="",c.value="",v.value=!1,g.value=null,b.value=null},H=()=>{_.push("/halaman-permohonan")};return E(()=>{if(!k||!B){_.push("/login");return}M()}),(a,t)=>(s(),n(V,null,[U($),e("div",K,[e("div",O,[t[19]||(t[19]=e("div",{class:"mb-8"},[e("h1",{class:"text-3xl font-bold text-gray-800 mb-2"},"Buat Pengajuan"),e("p",{class:"text-gray-600"},"Lengkapi informasi pengajuan untuk melanjutkan proses")],-1)),h.value?(s(),n("div",Q,t[3]||(t[3]=[y('<div class="inline-flex items-center px-4 py-2 bg-blue-50 rounded-lg" data-v-c3a3bb24><svg class="animate-spin h-5 w-5 mr-3 text-blue-600" fill="none" viewBox="0 0 24 24" data-v-c3a3bb24><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4" data-v-c3a3bb24></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z" data-v-c3a3bb24></path></svg><span class="text-blue-700 font-medium" data-v-c3a3bb24>Memuat data pengajuan...</span></div>',1)]))):m.value?(s(),n("div",W,[e("div",X,[t[5]||(t[5]=e("div",{class:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4"},[e("svg",{class:"w-6 h-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})])],-1)),e("p",Y,d(m.value),1),e("button",{onClick:M,class:"inline-flex items-center px-4 py-2 bg-red-600 hover:bg-red-700 text-white font-medium rounded-lg transition-colors duration-200"},t[4]||(t[4]=[e("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1),x(" Coba Lagi ")]))])])):(s(),n("div",Z,[e("div",ee,[t[10]||(t[10]=y('<div class="flex items-center mb-4" data-v-c3a3bb24><div class="w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center mr-3" data-v-c3a3bb24><svg class="w-5 h-5 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-c3a3bb24><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" data-v-c3a3bb24></path></svg></div><h2 class="text-xl font-semibold text-gray-800" data-v-c3a3bb24>Pilih Jenis Pengajuan</h2></div>',1)),e("div",te,[t[9]||(t[9]=e("label",{class:"block text-sm font-medium text-gray-700"},[x(" Jenis Pengajuan "),e("span",{class:"text-red-500"},"*")],-1)),j(e("select",{"onUpdate:modelValue":t[0]||(t[0]=l=>i.value=l),onChange:I,class:"w-full bg-white border border-gray-300 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"},[t[6]||(t[6]=e("option",{value:""},"Pilih jenis pengajuan...",-1)),(s(!0),n(V,null,G(f.value,l=>(s(),n("option",{key:l.id_pengajuan,value:l.id_pengajuan},d(l.nama_pengajuan),9,ae))),128))],544),[[q,i.value]]),u.value?(s(),n("div",ne,[e("div",se,[t[8]||(t[8]=e("svg",{class:"w-5 h-5 text-blue-600 mr-2 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),e("div",null,[t[7]||(t[7]=e("p",{class:"text-sm font-medium text-blue-800 mb-1"},"Pengajuan Terpilih:",-1)),e("p",oe,d(u.value.nama_pengajuan),1)])])])):w("",!0)])]),u.value?(s(),n("div",le,[t[16]||(t[16]=y('<div class="flex items-center mb-6" data-v-c3a3bb24><div class="w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center mr-3" data-v-c3a3bb24><svg class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-c3a3bb24><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" data-v-c3a3bb24></path></svg></div><h2 class="text-xl font-semibold text-gray-800" data-v-c3a3bb24>Form Pengajuan</h2></div>',1)),e("form",{onSubmit:R(A,["prevent"]),class:"space-y-6"},[e("div",null,[t[11]||(t[11]=e("label",{for:"applicationTitle",class:"block text-sm font-medium text-gray-700 mb-2"},[x(" Judul Pengajuan "),e("span",{class:"text-red-500"},"*")],-1)),j(e("input",{id:"applicationTitle","onUpdate:modelValue":t[1]||(t[1]=l=>r.value=l),type:"text",placeholder:u.value.nama_pengajuan,class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",required:""},null,8,re),[[z,r.value]]),t[12]||(t[12]=e("p",{class:"text-sm text-gray-500 mt-1"}," Judul akan otomatis terisi sesuai jenis pengajuan yang dipilih ",-1))]),e("div",null,[t[13]||(t[13]=e("label",{for:"additionalNotes",class:"block text-sm font-medium text-gray-700 mb-2"}," Catatan Tambahan ",-1)),j(e("textarea",{id:"additionalNotes","onUpdate:modelValue":t[2]||(t[2]=l=>c.value=l),rows:"4",placeholder:"Tambahkan catatan atau keterangan tambahan untuk pengajuan ini...",class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors resize-none"},null,512),[[z,c.value]])]),e("div",ie,[e("button",{type:"submit",disabled:p.value||!P.value,class:"inline-flex items-center px-6 py-3 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed text-white font-medium rounded-lg transition-colors duration-200"},[p.value?(s(),n("svg",de,t[14]||(t[14]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):(s(),n("svg",ce,t[15]||(t[15]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"},null,-1)]))),x(" "+d(p.value?"Membuat Pengajuan...":"Buat Pengajuan"),1)],8,ue)])],32)])):w("",!0),v.value?(s(),n("div",pe,[e("div",me,[t[18]||(t[18]=e("div",{class:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center mr-3"},[e("svg",{class:"w-5 h-5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})])],-1)),e("div",null,[t[17]||(t[17]=e("h3",{class:"text-lg font-semibold text-green-800 mb-1"},"Pengajuan Berhasil Dibuat!",-1)),e("p",ve,"ID Pengajuan: "+d(g.value),1),e("p",ge,"Judul: "+d(b.value),1)])]),e("div",{class:"mt-4 flex space-x-3"},[e("button",{onClick:D,class:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white font-medium rounded-lg transition-colors"}," Buat Pengajuan Baru "),e("button",{onClick:H,class:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors"}," Lihat Dokumen ")])])):w("",!0)]))])])],64))}},he=N(be,[["__scopeId","data-v-c3a3bb24"]]);export{he as default};
